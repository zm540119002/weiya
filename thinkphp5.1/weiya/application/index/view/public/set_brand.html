<!--商标列表模板-->
<section class="brandListTpl" style="display:none;">
    <li>
        <div class="list_top_item">
            <p>第3类商标</p>
            <div>
                <img src="public_img/default/no_pic_40.jpg" alt="" class="left" />
                <div>美肤品牌</div>
            </div>
        </div>
        <div class="columns_flex l-r-sides list_bottom_item">
            <div>
                <span></span>
                默认商标
            </div>
            <div>
                <a href="javascript:void(0);" class="brand_edit">修改</a>
                <a href="javascript:void(0);">删除</a>
            </div>
        </div>
    </li>
</section>
<!--增加商标-->
<section class="section-address bg-eae pt-5" style="display:none;">
    <form method="post" class="bg-fff brand_form">
        <!--<input type="hidden" class="" name="address_id" value="" />-->
        <div class="form-group box-flex clearfixed">
            <input type="text" name="brand_name" class="input-flex" placeholder="商标名称" value="">
        </div>
        <div class="form-group box-flex clearfixed">
            <select name="brand_type" id="">
                <option value="">商标类别</option>
                <option value="">1</option>
                <option value="">2</option>
            </select>
        </div>
        <div class="upload-picture-module f24">
			<div>
				<div class="picture-module">
					<input type="file" class="uploadImg uploadSingleImg" name="brand_logo">
					<img class="upload_img" src="" alt="">
					<input type="hidden" class="layer-thumbnail-picture img" data-src="" value=""/>
				</div>
			</div>
            <div>商标logo</div>
		</div>
        <div class="upload-picture-module f24">
			<div>
				<div class="picture-module">
					<input type="file" class="uploadImg uploadSingleImg" name="trademark_certificate">
					<img class="upload_img" src="" alt="">
					<input type="hidden" class="layer-thumbnail-picture img" data-src="" value=""/>
				</div>
			</div>
            <div>
                商标证或受理通知书
            </div>
		</div>
        <div class="upload-picture-module f24">
			<div>
				<div class="picture-module">
					<input type="file" class="uploadImg uploadSingleImg" name="trademark_authorization">
					<img class="upload_img" src="" alt="">
					<input type="hidden" class="layer-thumbnail-picture img" data-src="" value=""/>
				</div>
			</div>
            <div>
                如非自有商标需所有权者授权
            </div>
		</div>
    </form>
</section>
<!--设定品牌列表-->
<section class="delivery_address" style="display:none;">
        <!--<div class="item_addr">
            <div class="ia-l"></div>
            <div class="item_info">
                <input type="hidden" value="{$vo.id}" class="address_id"> 
                <div class="mt_new">
                    <span>{$vo.consignee}</span>
                    <span>{$vo.mobile}</span>
                    {if $vo.is_default eq 1 }
                    <i class="default_tipc">默认</i>
                    {/if}
                </div>
                <p class=""><span class="area_address" id="{$vo.id}"></span>{$vo.detail_address}</p>
                <form style="display:none;" class="consigneeInfo">
                    <input type="hidden" class="" name="province" value="{$vo.province}" />
                    <input type="hidden" class="" name="city" value="{$vo.city}" />
                    <input type="hidden" class="" name="area" value="{$vo.area}" />
                    <input type="hidden" class="" name="layer_id" value="{$vo.id}" />
                    <input type="hidden" class="" name="layer_consignee" value="{$vo.consignee}" />
                    <input type="hidden" class="" name="layer_mobile" value="{$vo.mobile}" />
                    <input type="hidden" class="" name="layer_detail_address" value="{$vo.detail_address}" />
                    <input type="hidden" class="" name="is_default" value="{$vo.is_default}" />
                </form>
            </div>
            <div class="edit_operate">
                <a href="javascript:void(0);" class="select_address">选择地址></a>
                <a href="javascript:void(0);" class="ia-r address_edit">
                    <span class="iar-icon"></span>
                </a>
            </div>
        </div>-->
    <ul class="list brand_list">
        
    </ul>
    <a href="javascript:void(0);" class="add_brand">增加商标</a>
</section>
<script type="text/javascript" src="public_js/uploadImgToTemp.js"></script>
<script>
//设定品牌
$('body').on('click','.select_address',function () {
    var delivery_address=$('.delivery_address').html();
    layer.open({
        title:['设定品牌','border-bottom:1px solid #d9d9d9;'],
        type:1,
        anim:'up',
        className:'setBrandLayer',
        content:delivery_address,
        success:function(){
            $('.addressLayer .item_info').each(function(index,val){
                //省市区初始化
                var _this=$(this);
                var data=_this.find('.consigneeInfo').serializeObject();
                var region = [];
                    region.push(data.province);
                    region.push(data.city);
                    region.push(data.area);
                    _this.find('.area_address').setArea(region);
                    $('.addressLayer').find('.select_address').hide();
                    $('.edit_operate').find('.address_edit').show();
                _this.on('click',function(){
                    _this.parents('.item_addr').addClass('active').siblings().removeClass('active');
                    var data=_this.parents('.item_addr').clone();
                    $('#address_info').find('.item_addr').remove();
                    $('#address_info').append(data);
                    $('#address_info').find('.select_address').show();
                    $('#address_info').find('.address_edit').hide();
                    setTimeout(function(){
                        layer.closeAll();
                    },1000)
                    return false;
                })
            });

        },
        yes:function(index){
            // addressLayer('增加商标');
            layer.close(index);
        }
    })
});
//增加商标
$('body').on('click','.add_brand',function () {
    var title='增加商标';
    //var data=$(this).parents('.item_addr').find('.consigneeInfo').serializeObject();
    addressLayer(title);
});
//修改商标
$('body').on('click','.brand_edit',function () {
    var title='修改商标';
    //var data=$(this).parents('.item_addr').find('.consigneeInfo').serializeObject();
    addressLayer(title);
});
//新增和修改品牌弹窗
var addressInfo=$('.section-address').html();
function addressLayer(title,data){
    layer.open({
        title:[title,'border-bottom:1px solid #d9d9d9;'],
        type:1,
        anim:'up',
        className:'setBrandLayer',
        content:addressInfo,
        btn:['确定','取消'],
        success:function(){
            if(data){
                $ ('input[name="consignee"]').val(data.layer_consignee);
                $ ('input[name="mobile"]').val(data.layer_mobile);
                $ ('input[name="detail_address"]').val(data.layer_detail_address);
                $ ('input[name="address_id"]').val(data.layer_id);
                var region = [];
                region.push(data.province);
                region.push(data.city);
                region.push(data.area);
                $('.addressLayer .area_address').setArea(region);
                if(data.is_default==1){
                    $('.addressLayer .myswitch').addClass('myswitched');
                    $('.addressLayer .myswitch').attr('data-off',1);
                }
            }
            
        },
        yes:function(index){
        //     var area_address =$('.addressLayer .area-address-name').getArea();
            var postData  = $(".setBrandLayer .brand_form").serializeObject();
            console.log(postData);
        //     var content='';
        //     if(!postData.consignee){
        //         content='请填写收货人姓名';
        //     }else if(!register.phoneCheck(postData.mobile)){
        //         content='请填写正确的手机号码';
        //     }else if(!area_address){
        //         content='请选择地区';
        //     }else if(!postData.detail_address){
        //         content='请填写详细地址';
        //     }
        //     if(content){
        //         dialog.error(content);
        //         return false;
        //     }
        //     postData.is_default = $('.addressLayer .myswitch').attr('data-off');
        //     postData.province = area_address[0];
        //     postData.city = area_address[1];
        //     postData.area = area_address[2];
        //     //添加或修改地址
        //     var _this = $(this);
        //     _this.addClass("nodisabled");//防止重复提交
        //     var url = module + '/Address/edit';
        //     $.ajax({
        //         url: url,
        //         data: postData,
        //         type: 'post',
        //         beforeSend: function(){
        //             $('.loading').show();
        //         },
        //         error:function(){
        //             $('.loading').hide();
        //             dialog.error('AJAX错误');
        //         },
        //         success: function(data){
        //             _this.removeClass("nodisabled");//删除防止重复提交
        //             $('.loading').hide();
        //             if(data.status == 0){

        //             }else{
        //                     $('#address_info').find('.item_addr,.add_address').remove();
        //                     $('#address_info').append(data);
        //                     var region = [];
        //                     region.push(postData.province);
        //                     region.push(postData.city);
        //                     region.push(postData.area);
        //                     $('.item_addr .area_address').setArea(region);
        //                     $('.edit_operate').find('.address_edit').hide();
        //                     var len=$('.delivery_address .item_addr').length;
                            
        //                     if(!postData.address_id){
        //                         if(!len){
        //                             $('.delivery_address ').append(data);
        //                         }else{
        //                             $('.delivery_address div:first').before(data);
        //                         }
                                    
        //                     }else{
        //                         $.each($('.delivery_address .item_addr'),function(index,val){
        //                             var _thisId=$(this).find('.address_id').val();
        //                             if(postData.address_id==_thisId){
                                        
        //                                 $(this).after(data);
        //                                     $(this).remove();
        //                             }
        //                         })
        //                     }
        //                     layer.closeAll();
        //             }
        //         }
        //     });
        // },
        // no:function(){
        //     $('.edit_operate').find('.address_edit').hide();
        //     layer.closeAll();
        // }
        }
    })
}
</script>